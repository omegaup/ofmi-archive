d expected to be in [0, K]
