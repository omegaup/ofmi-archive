n must be a power of two
