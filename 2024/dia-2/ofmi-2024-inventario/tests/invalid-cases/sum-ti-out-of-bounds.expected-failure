sum of ti should be at most 10^5
