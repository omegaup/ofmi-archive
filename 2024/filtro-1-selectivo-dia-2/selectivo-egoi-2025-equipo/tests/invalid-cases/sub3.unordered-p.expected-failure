Sub3: P must be sorted in non-decreasing order
