input should only have N + 3 lines
